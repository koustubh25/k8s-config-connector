apiVersion: composition.google.com/v1alpha1
kind: HelmConfiguration
metadata:
  name: teampage
spec:
  chart:
    apiVersion: v2
    name: team-page
    description: Teams landing page
    version: 0.1.0
  defaultValues:
    hteams:
      metadata:
        name: sample
        namespace: default
      spec:
        apps:
        - name: sample
          description: sample app
  templates:
  - name: configmap.yaml
    content:
      apiVersion: v1
      kind: ConfigMap
      metadata:
        name: team-{{ .Values.hteams.metadata.name }}-page
        namespace: default
      data:
        name: |
          {{ .Values.hteams.metadata.name  }}
---
apiVersion: composition.google.com/v1alpha1
kind: Composition
metadata:
  name: team-page-helm
spec:
  inputAPIGroup: hteams.facade.compositions.google.com    # Facade API
  expanders:
  - type: helm
    version: v0.0.1
    name: landing-page
    template: ""
    configref:
      name: teampage
      namespace: default
---
apiVersion: composition.google.com/v1alpha1
kind: Facade
metadata:
  name: helm-team
  namespace: default
spec:
  facadeKind: HTeam
  openAPIV3Schema:
  # Schema for the `spec` field
    type: object
    required:
    - apps
    properties:
      apps:
        type: array
        items:
          type: object
          required:
          - description
          - name
          properties:
            contact:
              type: string
            description:
              type: string
            name:
              type: string